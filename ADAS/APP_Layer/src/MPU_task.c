/**
 * @file    MPU_task.c
 * @author  Ahmed Hani
 * @brief   contains task of MPU 
 * @date    2025-02-08
 */

/***********************************************************************************************************************
*                                                      INCLUDES                                                        *
***********************************************************************************************************************/
#include "APP.h"
#include "MPU_task.h"



/***********************************************************************************************************************
*                                                    MACRO DEFINES                                                     *
***********************************************************************************************************************/




/***********************************************************************************************************************
*                                                   MACRO FUNCTIONS                                                    *
***********************************************************************************************************************/




/***********************************************************************************************************************
*                                               STATIC FUNCTION DEFINITION                                             *
***********************************************************************************************************************/





/***********************************************************************************************************************
*                                                     GLOBAL OBJECTS                                                   *
***********************************************************************************************************************/






/***********************************************************************************************************************
*                                                     STATIC OBJECTS                                                   *
***********************************************************************************************************************/






/***********************************************************************************************************************
*                                                      DATA TYPES                                                      *
***********************************************************************************************************************/




/***********************************************************************************************************************
*                                                  FUNCTION DECLARATION                                                *
***********************************************************************************************************************/

/**
 * @brief initialize the task of MPU
 * @param p_UsedMPU pointer to the used MPU
 * @return app_status_t status of operation
 */
app_status_t MPU_task_init(mpu_t *p_UsedMPU)
{
    app_status_t l_AppStatus = APP_OK;
    if (NULL == p_UsedMPU)
    {
        l_AppStatus = APP_ERROR;
    }
    else
    {
        ecu_status_t l_EcuStatus = MPU6050_Init(p_UsedMPU->UsedI2C, p_UsedMPU->mpu);
        if (l_EcuStatus != ECU_OK)
        {
            l_AppStatus = APP_ERROR;
        }
    }
    return l_AppStatus;
}

/**
 * @brief  task of MPU which update the values (specially YAW)
 * @param p_UsedMPU pointer to the used MPU
 * @return app_status_t status of operation
 */
app_status_t MPU_update_task(mpu_t *p_UsedMPU)
{
    app_status_t l_AppStatus = APP_OK;
    if (NULL == p_UsedMPU)
    {
        l_AppStatus = APP_ERROR;
    }
    else
    {
        ecu_status_t l_EcuStatus = MPU6050_Read_All(p_UsedMPU->UsedI2C, p_UsedMPU->mpu);
        if (l_EcuStatus != ECU_OK)
        {
            l_AppStatus = APP_ERROR;
        }
        else
        {
            p_UsedMPU->YAW = p_UsedMPU->mpu->Yaw;
        }
    }
    return l_AppStatus;
}


/***********************************************************************************************************************
*                                               STATIC FUNCTION DECLARATION                                            *
***********************************************************************************************************************/




/***********************************************************************************************************************
* AUTHOR                |* NOTE                                                                                        *
************************************************************************************************************************
*                       |                                                                                              * 
*                       |                                                                                              * 
***********************************************************************************************************************/
